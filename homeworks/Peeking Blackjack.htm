
<!-- saved from url=(0068)http://web.stanford.edu/class/cs221/assignments/blackjack/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <title>Peeking Blackjack</title>
  <script src="./Peeking Blackjack_files/main.js"></script><script src="./Peeking Blackjack_files/MathJax.js">MathJax.Hub.Config({  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],  tex2jax: {inlineMath: [["$", "$"]]},});</script><script src="./Peeking Blackjack_files/jquery.min.js"></script><link rel="stylesheet" href="./Peeking Blackjack_files/main.css">
  <script src="./Peeking Blackjack_files/results.js"></script>
<style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body onload="onLoad(&#39;blackjack&#39;, &#39;Anna Zhu&#39;, 1)"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<div id="assignmentHeader"><div><div class="assignmentTitle">Peeking Blackjack</div><div><b>Stanford CS221 Summer 2019</b></div></div><p>Owner CA: Anna Zhu</p><p>Version: 1</p><hr><div class="problemTitle">General Instructions</div><p>This (and every) assignment has a written part and a programming part.</p><p>The full assignment with our supporting code and scripts can be downloaded as <a href="http://web.stanford.edu/class/cs221/assignments/blackjack.zip">blackjack.zip</a>.</p><ol class="problem"><li class="writeup template">This icon means a written answer is expected in <code>blackjack.pdf</code>.</li><li class="code template">This icon means you should write code in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>.</li></ol><p>All written answers must be <b>in order</b> and <b>clearly and correctly labeled</b> to receive credit.</p><p>You should modify the code in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code> between <pre># BEGIN_YOUR_CODE</pre> and <pre># END_YOUR_CODE</pre> but you can add other helper functions outside this block if you want. Do not make changes to files other than <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>.</p><p>Your code will be evaluated on two types of test cases, <b>basic</b> and <b>hidden</b>, which you can see in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code>. Basic tests, which are fully provided to you, do not stress your code with large inputs or tricky corner cases. Hidden tests are more complex and do stress your code.  The inputs of hidden tests are provided in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code>, but the correct outputs are not. To run the tests, you will need to have <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/graderUtil.py">graderUtil.py</a></code> in the same directory as your code and <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code>. Then, you can run all the tests by typing <pre>python grader.py</pre> This will tell you only whether you passed the basic tests. On the hidden tests, the script will alert you if your code takes too long or crashes, but does not say whether you got the correct output. You can also run a single test (e.g., <code>3a-0-basic</code>) by typing <pre>python grader.py 3a-0-basic</pre>We strongly encourage you to read and understand the test cases, create your own test cases, and not just blindly run <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code>.</p><hr></div>

<p>
<img class="float-right" src="./Peeking Blackjack_files/blackjack.jpg" style="width:260px;margin-left:10px">
</p>

<p>
The search algorithms explored in the previous assignment work great when you
know exactly the results of your actions.  Unfortunately, the real world is
not so predictable.  One of the key aspects of an effective AI is the ability
to reason in the face of uncertainty.  
</p>

<p>
Markov decision processes (MDPs) can be used to formalize uncertain situations.
In this homework, you will implement algorithms to find the optimal policy in these situations.
You will then formalize a modified version of Blackjack as an MDP, and apply your algorithm
to find the optimal policy.  
</p>

<!------------------------------------------------------------>
<div class="problemTitle">Problem 1: Value Iteration</div>

<p>
In this problem, you will perform the value iteration updates manually on a
very basic game just to solidify your intuitions about solving MDPs.
The set of possible states in this game is {-2, -1, 0, 1, 2}.  You start at state 0, and if you reach either -2 or 2, the game ends.  
At each state, you can take one of two actions: {-1, +1}.
</p><p>
If you're in state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.37em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">s</script> and choose -1:
</p><ul> 
         <li> You have an 80% chance of reaching the state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1001.98em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">&#8722;</span><span class="mn" id="MathJax-Span-8" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">s-1</script>.
         </li><li> You have a 20% chance of reaching the state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-9" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1001.98em, 2.711em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-13" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">s+1</script>.
</li></ul>
If you're in state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-14" style="width: 0.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.37em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">s</script> and choose +1:
<ul> 
         <li> You have a 70% chance of reaching the state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-17" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1001.98em, 2.711em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">s+1</script>.
         </li><li> You have a 30% chance of reaching the state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-22" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1001.98em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-25" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">&#8722;</span><span class="mn" id="MathJax-Span-26" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">s-1</script>.
</li></ul>

If your action results in transitioning to state -2,
then you receive a reward of 20.
If your action results in transitioning to state 2,
then your reward is 100.
Otherwise, your reward is -5.
Assume the discount factor <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-27" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.47em, 2.867em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral-Italic;">&#947;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\gamma</script> is 1.
<p></p>

<ol class="problem">

<li class="writeup" id="1a">[3 points]
Give the value of <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-30" style="width: 3.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.61em, 2.971em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mtext" id="MathJax-Span-34" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-36" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-37" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">V_\text{opt}(s)</script> for each state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-38" style="width: 0.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.37em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">s</script> after 0, 1, and 2 iterations of value iteration. Iteration 0 just initializes all the values of <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1000.68em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">V</script> to 0. Terminal states do not have any optimal policies and take on a value of 0.

</li><li class="writeup" id="1b">[3 points]
What is the resulting optimal policy <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-44" style="width: 1.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.419em, 1001.46em, 1.461em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-45"><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 1.461em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral-Italic;">&#960;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.523em;"><span class="mtext" id="MathJax-Span-48" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\pi_\text{opt}</script> for all non-terminal states?

</li></ol>

<!------------------------------------------------------------>
<div class="problemTitle">Problem 2: Transforming MDPs</div>

<p>
Let's implement value iteration to compute the optimal policy on an arbitrary MDP.
Later, we'll create the specific MDP for Blackjack.
</p>

<ol class="problem">

<li class="code" id="2a">[3 points]
If we add noise to the transitions of an MDP, does the optimal
value always get worse?
Specifically, consider an MDP with reward function
<span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-49" style="width: 7.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1006.2em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="mtext" id="MathJax-Span-51" style="font-family: STIXGeneral-Regular;">Reward</span><span class="mo" id="MathJax-Span-52" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-57" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-58" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-59" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\text{Reward}(s,a,s')</script>, states <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-61" style="width: 2.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.35em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mtext" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular;">States</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\text{States}</script>, and transition function
<span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-64" style="width: 4.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1003.75em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-69" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-70" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-71" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-72" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">T(s,a,s')</script>.  Let's define a new MDP which is identical to the original, except
that on each action, with probability <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-76" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.049em, 1000.68em, 1.513em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mfrac" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;"><span class="mn" id="MathJax-Span-79" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.154em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.47em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.471em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\frac{1}{2}</script>, we randomly jump to one of the
states that we could have reached before with positive probability.
Formally, this modified transition function is:
<span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="text-align: center;"><nobr><span class="math" id="MathJax-Span-81" style="width: 27.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.867em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.992em, 1022.82em, 3.544em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="msup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.732em;"><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-88" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-90" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-91" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mo" id="MathJax-Span-93" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">=</span><span class="mfrac" id="MathJax-Span-96" style="padding-left: 0.315em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-98" style="font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-102" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-104" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-105" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mfrac" id="MathJax-Span-110" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-111" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-112" style="font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">&#8901;</span><span class="mfrac" id="MathJax-Span-114" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 9.326em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-115" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1009.12em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -4.581em;"><span class="mrow" id="MathJax-Span-116"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mo" id="MathJax-Span-119" style="font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: STIXGeneral-Regular;">{</span><span class="msup" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.367em;"><span class="mo" id="MathJax-Span-123" style="font-size: 70.7%; font-family: STIXVariants;">&#8243;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">:</span><span class="mi" id="MathJax-Span-125" style="font-family: STIXGeneral-Italic; padding-left: 0.315em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-128" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-130" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-131" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-132" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.367em;"><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: STIXVariants;">&#8243;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-135" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">&gt;</span><span class="mn" id="MathJax-Span-136" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">0</span><span class="mo" id="MathJax-Span-137" style="font-family: STIXGeneral-Regular;">}</span><span class="texatom" id="MathJax-Span-138"><span class="mrow" id="MathJax-Span-139"><span class="mo" id="MathJax-Span-140" style="font-family: STIXVariants;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1009.33em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.326em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-141" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">T'(s,a,s')= \frac{1}{2} T(s,a,s') + \frac{1}{2} \cdot \frac{1}{|\{ s'' : T(s, a, s'') > 0\}|}.</script>
<p>
Let <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-142" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.159em, 1001.04em, 1.305em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-145" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mn" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">V_1</script> be the optimal value function for the
original MDP, and <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-147" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.159em, 1001.04em, 1.305em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-148"><span class="msubsup" id="MathJax-Span-149"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-150" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mn" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">V_2</script> the optimal value function for the modified MDP.
Is it always the case that <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-152" style="width: 9.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.076em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1008.02em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-155" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mn" id="MathJax-Span-156" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.367em;"><span class="mtext" id="MathJax-Span-160" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">start</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-162" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">&#8805;</span><span class="msubsup" id="MathJax-Span-163" style="padding-left: 0.315em;"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mn" id="MathJax-Span-165" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.367em;"><span class="mtext" id="MathJax-Span-169" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">start</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">V_1(s_\text{start})\geq
V_2(s_\text{start})</script>?  If so,
prove it on the written portion and put <code>return None</code> for each of the code blocks.
Otherwise, construct a counterexample by filling out <code>CounterexampleMDP</code> in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>.
</p>

</li>

<li class="writeup" id="2b">[3 points]
Suppose we have an acyclic MDP for which we want to find the optimal value at each node.  We could run value iteration,
    which would require multiple iterations -- but it would be nice to be more efficient for MDPs with this acyclic property.
Briefly explain an algorithm that will allow us to compute <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-171" style="width: 1.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.159em, 1001.62em, 1.461em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mtext" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">V_\text{opt}</script> for each node with only a single pass over all the <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-176" style="width: 3.909em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1003.18em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-180" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-181" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-182" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-183" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-185" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">(s, a, s')</script> triples.
</li>

<li class="writeup" id="2c">[3 points]
Suppose we have an MDP with states <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-187" style="width: 2.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.35em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mtext" id="MathJax-Span-189" style="font-family: STIXGeneral-Regular;">States</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\text{States}</script> and a discount factor <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-190" style="width: 2.763em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.294em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.19em, 2.867em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-family: STIXGeneral-Italic;">&#947;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">&lt;</span><span class="mn" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\gamma < 1</script>,
but we have an MDP solver that can only solve MDPs with discount factor of <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-195" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1000.42em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mn" id="MathJax-Span-197" style="font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">1</script>.
How can we leverage the MDP solver to solve the original MDP?
<p>
Let us define a new MDP with states <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-198" style="width: 10.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.013em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1008.91em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="msup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 2.711em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1002.35em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-201" style="font-family: STIXGeneral-Regular;">States</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 2.398em;"><span class="mo" id="MathJax-Span-202" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-203" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">=</span><span class="mtext" id="MathJax-Span-204" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">States</span><span class="mo" id="MathJax-Span-205" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">&#8746;</span><span class="mo" id="MathJax-Span-206" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">{</span><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral-Italic;">o</span><span class="mo" id="MathJax-Span-208" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\text{States}' = \text{States} \cup \{ o \}</script>,
where <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-209" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.47em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-family: STIXGeneral-Italic;">o</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">o</script> is a new state.  Let's use the same actions (<span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-212" style="width: 11.982em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.951em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1009.9em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="msup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1003.08em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-215" style="font-family: STIXGeneral-Regular;">Actions</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 3.128em;"><span class="mo" id="MathJax-Span-216" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-220" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">=</span><span class="mtext" id="MathJax-Span-221" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">Actions</span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-223" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-224" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\text{Actions}'(s) = \text{Actions}(s)</script>),
but we need to keep the discount <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-225" style="width: 3.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1002.55em, 2.867em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="msup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: STIXGeneral-Italic;">&#947;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.523em;"><span class="mo" id="MathJax-Span-229" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">=</span><span class="mn" id="MathJax-Span-231" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\gamma' = 1</script>.
Your job is to define new transition probabilities <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-232" style="width: 5.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.273em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1004.22em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-233"><span class="msup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.732em;"><span class="mo" id="MathJax-Span-236" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-237" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-239" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-240" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-242" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-245" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">T'(s, a, s')</script> and rewards <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-246" style="width: 8.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1006.62em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-247"><span class="msup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 3.44em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1003.13em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mtext" id="MathJax-Span-249" style="font-family: STIXGeneral-Regular;">Reward</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 3.128em;"><span class="mo" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-252" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-256" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\text{Reward}'(s, a, s')</script>
in terms of the old MDP
such that the optimal values <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-260" style="width: 3.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.61em, 2.971em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-261"><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.628em;"><span class="mtext" id="MathJax-Span-264" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-266" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">V_\text{opt}(s)</script> for all <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-268" style="width: 4.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1004.07em, 2.711em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-271" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">&#8712;</span><span class="mtext" id="MathJax-Span-272" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">States</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">s \in \text{States}</script>
are equal under the original MDP and the new MDP.</p>

<p style="font-style: italic;">
    Hint: If you're not sure how to approach this problem, go back to the notes from the first MDP lecture
    and read closely the slides on convergence, toward the end of the deck.
</p>

</li>

</ol>

<!------------------------------------------------------------>
<div class="problemTitle">Problem 3: Peeking Blackjack</div>

<p>
Now that we have gotten a bit of practice with general-purpose MDP algorithms, let's use them to play (a modified version of) Blackjack.
For this problem, you will be creating an MDP to describe states, actions, and rewards in this game.
</p>

<p>
For our version of Blackjack, the deck can contain an
arbitrary collection of cards with different face values.  At the start of the game,
    the deck contains the same number of each card of each face value; we call this number
    the 'multiplicity'.  For example, a standard deck of 52 cards would have face values <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-273" style="width: 6.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.263em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1005.16em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-274"><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-277" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">2</span><span class="mo" id="MathJax-Span-279" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-280" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;"></span><span class="mo" id="MathJax-Span-281" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">,</span><span class="mn" id="MathJax-Span-282" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">13</span><span class="mo" id="MathJax-Span-283" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">[1, 2, \ldots,
13]</script> and multiplicity 4.  You could also have a deck with face values
<span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-284" style="width: 4.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.596em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1003.49em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-285"><span class="mo" id="MathJax-Span-286" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-287" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-288" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-289" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">5</span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-291" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">20</span><span class="mo" id="MathJax-Span-292" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">[1,5,20]</script>; if we used multiplicity 10 in this case, there would be 30 cards in total (10 each of 1s, 5s, and 20s).
The deck is shuffled, meaning that each permutation of the cards is equally likely.
</p>

<p>
The game occurs in a sequence of rounds.
Each round, the player either
(i) takes the next card from the top of the deck (costing nothing),
(ii) peeks at the top card
(costing <code>peekCost</code>, in which case the next round, that card will be drawn),
or (iii) quits the game.
(Note: it is not possible to peek twice in a row; if the player peeks twice in a row, then
<code>succAndProbReward()</code> should return <code>[]</code>.)
</p>

<p>
The game continues until one of the following conditions becomes true:
</p><ul>
   <li>The player quits, in which case her reward is the sum of the face values of the cards in her hand.
   </li><li>The player takes a card and "goes bust".  This means that the sum of the face values
    of the cards in her hand is strictly greater than the threshold specified at the start
    of the game.  If this happens, her reward is 0.
   </li><li>The deck runs out of cards, in which case it is as if she quits, and she
gets a reward which is the sum of the cards in her hand. <span style="font-style: italic;">
    Make sure that if you take the last card and go bust, then the reward becomes 0. (Not
    the sum of values of cards)
    </span>
</li></ul>
<p></p>

<p>
In this problem, your state <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-293" style="width: 0.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.37em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">s</script> will be represented as a 3-element tuple:
</p><blockquote>
  <code>(totalCardValueInHand, nextCardIndexIfPeeked, deckCardCounts)</code>
</blockquote>
As an example, assume the deck has card values <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-296" style="width: 3.701em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1002.97em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-297"><span class="mo" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-299" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-300" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">2</span><span class="mo" id="MathJax-Span-302" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-303" style="font-family: STIXGeneral-Regular; padding-left: 0.211em;">3</span><span class="mo" id="MathJax-Span-304" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">[1, 2, 3]</script> with multiplicity 1,
and the threshold is 4.
Initially, the player has no cards, so her total is 0;
this corresponds to state <code>(0, None, (1, 1, 1))</code>.
At this point, she can take, peek, or quit.
<ul>
  <li>If she takes a card, then the three possible 
successor states (each of which has equal probability of <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-305" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.305em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1001.25em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mn" id="MathJax-Span-307" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-311" style="font-family: STIXGeneral-Regular;">3</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">1/3</script>) are:
<blockquote>
  <code>(1, None, (0, 1, 1))</code><br>
  <code>(2, None, (1, 0, 1))</code><br>
  <code>(3, None, (1, 1, 0))</code><br>
</blockquote>
She will receive a reward of 0 for reaching any of these states.  (Remember, even though she now has a card in her hand
    for which she may receive a reward at the end of the game, the reward is not actually granted until the game ends.)
</li><li>
If she peeks, the three possible successor states are:
<blockquote>
  <code>(0, 0, (1, 1, 1))</code><br>
  <code>(0, 1, (1, 1, 1))</code><br>
  <code>(0, 2, (1, 1, 1))</code><br>
</blockquote>
    She will receive (immediate) reward <code>-peekCost</code> for reaching any of these states.
    Things to remember about the states after a peek action:
    <ul>
        <li>From <code>(0, 0, (1, 1, 1))</code>, taking a card will lead to the state <code>(1, None, (0, 1, 1))</code> deterministically.</li>
        <li>
            The second element of the state tuple is not the face value of the card that will be drawn next, but the
            index into the deck (the third element of the state tuple) of the card that will be drawn next.  In other words,
            the second element will always be between 0 and <code>len(deckCardCounts)-1</code>, inclusive.
        </li>
    </ul>
</li>
    <li>
        If she quits, then the resulting state will be <code>(0, None, None)</code>.
        (Remember that setting the deck to <code>None</code> signifies the end of the game.)
    </li>
</ul>
As another example, let's say the player's current state is <code>(3, None, (1, 1, 0))</code>, and the threshold remains 4.
<ul>
  <li>If she quits, the successor state will be <code>(3, None, None)</code>.</li>
  <li>If she takes, the successor states are <code>(3 + 1, None, (0, 1, 0))</code> or <code>(3 + 2, None, None)</code>.
Note that in the second successor state, the deck is set to <code>None</code> to signify the game ended with a bust.
You should also set the deck to <code>None</code> if the deck runs out of cards.</li>
</ul>

<ol class="problem">

<li class="code" id="3a">[10 points]
Implement the game of Blackjack as an MDP by filling out the
<code>succAndProbReward()</code> function of class <code>BlackjackMDP</code>.
</li>

<li class="code" id="3b">[4 points]
Let's say you're running a casino, and you're trying to design a deck to make
people peek a lot.  Assuming a fixed threshold of 20, and a peek cost of 1,
design a deck where for more than 10% of states, the optimal policy is to peek.
Fill out the function <code>peekingMDP()</code> to return an instance of
<code>BlackjackMDP</code> where the optimal action is to peek in at least
10% of states. <span style="font-style: italic;">Hint: Before randomly
assinging values, think of the case when you really want to peek instead
of blindly taking a card. </span>
</li>

</ol>

<!------------------------------------------------------------>
<div class="problemTitle">Problem 4: Learning to Play Blackjack</div>

<p>
So far, we've seen how MDP algorithms can take an MDP which describes the full
dynamics of the game and return an optimal policy.  But suppose you go into
a casino, and no one tells you the rewards nor the transitions.
We will see how reinforcement learning can allow you to play the game
and learn its rules &amp; strategy at the same time!
</p>

<ol class="problem">

<li class="code" id="4a">[8 points]
You will first implement a generic Q-learning algorithm <code>QLearningAlgorithm</code>,
which is an instance of an <code>RLAlgorithm</code>.  As discussed in class,
reinforcement learning algorithms are capable of executing a policy while
simultaneously improving that policy.  Look in <code>simulate()</code>, in
<code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/util.py">util.py</a></code> to see how the <code>RLAlgorithm</code> will be used.  In
short, your <code>QLearningAlgorithm</code> will be run in a simulation of the MDP, and will
alternately be asked for an action to perform in a given state (<code>QLearningAlgorithm.getAction</code>), and then be
informed of the result of that action (<code>QLearningAlgorithm.incorporateFeedback</code>),
so that it may learn better actions to perform in the future.
<p></p>

<p>
We are using Q-learning with function approximation,
which means <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-312" style="width: 11.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.409em, 1009.17em, 3.023em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="munderover" id="MathJax-Span-317"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-318" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.211em;"><span style="height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-319" style="font-family: STIXGeneral-Regular;">&#770;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.258em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.799em; left: 0.732em;"><span class="mtext" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-321" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-322" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-323" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-324" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-325" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-326" style="font-family: STIXGeneral-Regular; padding-left: 0.315em;">=</span><span class="texatom" id="MathJax-Span-327" style="padding-left: 0.315em;"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral-Regular;">&#120168;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-330" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">&#8901;</span><span class="mi" id="MathJax-Span-331" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">&#981;</span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-333" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-334" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-335" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">\hat Q_\text{opt}(s, a) = \mathbb w \cdot \phi(s, a)</script>,
where in code, <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-337" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.878em, 1000.68em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="texatom" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: STIXGeneral-Regular;">&#120168;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">\mathbb w</script> is <code>self.weights</code>, <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-342" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.669em, 1000.58em, 2.867em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-family: STIXGeneral-Italic;">&#981;</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">\phi</script> is the <code>featureExtractor</code> function,
and <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-345" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.102em, 1001.72em, 1.513em, -999.997em); top: -0.987em; left: 0em;"><span class="mrow" id="MathJax-Span-346"><span class="msubsup" id="MathJax-Span-347"><span style="display: inline-block; position: relative; width: 1.721em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-348"><span class="mrow" id="MathJax-Span-349"><span class="munderover" id="MathJax-Span-350"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-351" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.32em; left: 0.211em;"><span style="height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-352" style="font-family: STIXGeneral-Regular;">&#770;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.258em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.799em; left: 0.732em;"><span class="mtext" id="MathJax-Span-353" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">opt</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.992em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">\hat Q_\text{opt}</script> is <code>self.getQ</code>.
</p><p>
We have implemented <code>QLearningAlgorithm.getAction</code> as a simple <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-354" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.93em, 1000.47em, 2.659em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-family: STIXGeneral-Italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">\epsilon</script>-greedy policy.
Your job is to implement <code>QLearningAlgorithm.incorporateFeedback()</code>,
which should take an <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-357" style="width: 4.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.065em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1004.01em, 2.815em, -999.997em); top: -2.497em; left: 0em;"><span class="mrow" id="MathJax-Span-358"><span class="mo" id="MathJax-Span-359" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-360" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-361" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-363" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral-Italic; padding-left: 0.211em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-365" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-366" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-367" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mo" id="MathJax-Span-368" style="font-size: 70.7%; font-family: STIXVariants;">&#8242;</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.503em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">(s, a, r, s')</script> tuple and update <code>self.weights</code>
according to the standard Q-learning update.
</p>
</li>

<li class="writeup" id="4b">[4 points]
  Now let's apply Q-learning to an MDP and see how well it performs
  in comparison with value iteration.  First, call <code>simulate</code>
  using your Q-learning code and the <code>identityFeatureExtractor()</code> on the MDP <code>smallMDP</code>
  (defined for you in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>), with 30000 trials and default <code>explorationProb</code>.
  Next, use value iteration to find out the optimal policy for <code>smallMDP</code>.<p></p>

  <p>  How does the Q-learning policy compare with a policy learned by value iteration
    (i.e., for how many states do they produce a different action)?
    (Don't forget to set the <code>explorationProb</code> of your Q-learning algorithm to 0 after learning the policy.)</p>

    Now repeat what you have done on <code>largeMDP</code>, again with 30,000 trials.  How does the policy
    learned in this case compare to the policy learned by value iteration?  What went wrong? <p></p>
  <p>
    <b>Note:</b> We have provided the helper function <code>run4bHelper</code> in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code> 
    to help you run <code>simulate_QL_over_MDP</code> with appropriate arguments. The implementation of
    <code>simulate_QL_over_MDP</code> and the use of <code>run4bHelper</code> are totally optional, 
    but it will probably be useful to you as you work to answer this question.
  </p>


</li>

<li class="code" id="4c">[5 points]
To address the problems explored in the previous exercise, let's incorporate some
domain knowledge to improve generalization.  This way, the algorithm can use
what it has learned about some states to improve its prediction performance on
other states. Implement <code>blackjackFeatureExtractor</code> as described in the code comments.
Using this feature extractor, you should be able to get pretty close to the
optimum on the <code>largeMDP</code>.
</li>

<li class="writeup" id="4d">[4 points]
Sometimes, we might reasonably wonder how an optimal policy learned for one MDP
    might perform if applied to another MDP with similar structure but slightly
    different characteristics.  For example, imagine that you created an MDP to
    choose an optimal strategy for playing "traditional" blackjack, with a standard
    card deck and a threshold of 21.  You're living it up in Vegas
    every weekend, but the casinos get wise to your approach and decide to make
    a change to the game to disrupt your strategy: going forward, the threshold
    for the blackjack tables is 17 instead of 21.  If you continued playing the
    modified game with your original policy, how well would you do?  (This is just
    a hypothetical example; we won't look specifically at the blackjack game in
    this problem.)

    <p>
        To explore this scenario, let's take a brief look at how a policy learned
        using value iteration responds to a change in the rules of the MDP.
    </p>
    <ul>
        <li>
            First, run value iteration on the <code>originalMDP</code>
            (defined for you in <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>) to compute an
            optimal policy for that MDP.
        </li>
        <li>
            Next, simulate your policy on <code>newThresholdMDP</code> (also defined for you in
            <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/submission.py">submission.py</a></code>) by calling <code>simulate</code> with an instance of
            <code>FixedRLAlgorithm</code> that has been instantiated using the policy you computed
            with value iteration.  What is the expected reward from this simulation?
            <span style="font-style: italic;">Hint: read the documentation (comments) for the
            <code>simulate</code> function in util.py, and look specifically at the format of the
            function's return value.</span>
        </li>
        <li>
            Now try simulating Q-learning on <code>originalMDP</code> (30,000 trials).
            Then, using the learned parameters, run Q-learning again on
            <code>newThresholdMDP</code> (again, 30000 trials). What is your
            expected reward under the new Q-learning policy? Provide some explanation for how
            the rewards compare with when <code>FixedRLAlgorithm</code> is used. Why they are
            different? <br><br>

        </li>
    </ul>

    <p>
    <b>Note:</b> As in 4(b), we have provided the helper function <code>run4dHelper</code> in 
    <code><a href="http://web.stanford.edu/class/cs221/assignments/blackjack/grader.py">grader.py</a></code> to help you run <code>compare_changed_MDP</code> with appropriate arguments.
    The implementation of <code>compare_changed_MDP</code> and the use of <code>run4dHelper</code> are
    totally optional, but it will probably be useful to you as you work to answer this question.
  </p>


</li>

</ol>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>